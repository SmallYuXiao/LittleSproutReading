<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnapAny g-footer æ‹¦æˆªå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .step {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #764ba2;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .code-box {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            position: relative;
        }
        
        .code-box pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .copy-btn:hover {
            background: #764ba2;
            transform: scale(1.05);
        }
        
        .copy-btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.3);
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .alert-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }
        
        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }
        
        .alert-success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }
        
        .results {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            display: none;
        }
        
        .results.show {
            display: block;
        }
        
        .result-item {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: #f8f9fa;
        }
        
        .result-item.match {
            background: #d4edda;
            border: 2px solid #28a745;
        }
        
        .icon {
            margin-right: 8px;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” SnapAny g-footer æ‹¦æˆªå™¨</h1>
        <p class="subtitle">è‡ªåŠ¨åŒ–é€†å‘å·¥ç¨‹å·¥å…· - ä¸€é”®ç ´è§£ API ç­¾åç®—æ³•</p>
        
        <div class="section">
            <h2>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h2>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>å¤åˆ¶ä¸‹æ–¹çš„æ‹¦æˆªè„šæœ¬</strong>
            </div>
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>æ‰“å¼€ SnapAny ç½‘ç«™ï¼š</strong>
                <a href="https://snapany.com/zh/youtube-1" target="_blank">https://snapany.com/zh/youtube-1</a>
            </div>
            
            <div class="step">
                <span class="step-number">3</span>
                <strong>æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåˆ‡æ¢åˆ° Consoleï¼ˆæ§åˆ¶å°ï¼‰</strong>
            </div>
            
            <div class="step">
                <span class="step-number">4</span>
                <strong>ç²˜è´´å¹¶è¿è¡Œæ‹¦æˆªè„šæœ¬ï¼ˆæŒ‰å›è½¦ï¼‰</strong>
            </div>
            
            <div class="step">
                <span class="step-number">5</span>
                <strong>åœ¨ SnapAny é¡µé¢è¾“å…¥ YouTube é“¾æ¥å¹¶ç‚¹å‡»"æå–è§†é¢‘å›¾ç‰‡"</strong>
            </div>
            
            <div class="step">
                <span class="step-number">6</span>
                <strong>æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºçš„å®Œæ•´è°ƒç”¨å †æ ˆå’Œå‚æ•°ä¿¡æ¯</strong>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ¯ æ‹¦æˆªè„šæœ¬ï¼ˆç‚¹å‡»å¤åˆ¶ï¼‰</h2>
            
            <div class="code-box">
                <button class="copy-btn" onclick="copyScript()">ğŸ“‹ å¤åˆ¶è„šæœ¬</button>
                <pre id="interceptor-script">// ============================================================
// SnapAny g-footer é«˜çº§æ‹¦æˆªè„šæœ¬
// ============================================================
(function() {
    console.log('%cğŸ¯ SnapAny æ‹¦æˆªå™¨å·²å¯åŠ¨', 'background: #667eea; color: white; padding: 10px; font-size: 16px; font-weight: bold;');
    
    const results = {
        captures: [],
        functions: []
    };
    
    // ============================================================
    // 1. æ‹¦æˆª Fetch API
    // ============================================================
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        const [url, options] = args;
        
        if (url.includes('api.snapany.com') || url.includes('extract')) {
            console.log('%câ”'.repeat(80), 'color: #667eea');
            console.log('%cğŸ¯ æ‹¦æˆªåˆ° Fetch è¯·æ±‚', 'background: #28a745; color: white; padding: 5px; font-weight: bold;');
            console.log('URL:', url);
            console.log('Method:', options?.method);
            console.log('Headers:', JSON.stringify(options?.headers, null, 2));
            console.log('Body:', options?.body);
            
            if (options?.headers) {
                const gFooter = options.headers['g-footer'];
                const gTimestamp = options.headers['g-timestamp'];
                
                if (gFooter && gTimestamp) {
                    const capture = {
                        timestamp: gTimestamp,
                        footer: gFooter,
                        body: options.body,
                        url: url,
                        time: new Date().toISOString()
                    };
                    
                    results.captures.push(capture);
                    
                    console.log('%câœ… æˆåŠŸæ•è·ç­¾åæ•°æ®ï¼', 'background: #28a745; color: white; padding: 5px; font-weight: bold;');
                    console.log('g-footer:', gFooter);
                    console.log('g-timestamp:', gTimestamp);
                    console.log('Body:', options.body);
                    console.log('%cè°ƒç”¨å †æ ˆï¼š', 'color: #667eea; font-weight: bold;');
                    console.trace();
                    
                    // å°è¯•ç ´è§£ç®—æ³•
                    analyzeFooter(capture);
                }
            }
            console.log('%câ”'.repeat(80), 'color: #667eea');
        }
        
        return originalFetch.apply(this, args);
    };
    
    // ============================================================
    // 2. æ‹¦æˆª XMLHttpRequest
    // ============================================================
    const xhrData = new WeakMap();
    
    const originalOpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(method, url, ...rest) {
        if (url.includes('api.snapany.com') || url.includes('extract')) {
            xhrData.set(this, { method, url, headers: {} });
        }
        return originalOpen.apply(this, [method, url, ...rest]);
    };
    
    const originalSetRequestHeader = XMLHttpRequest.prototype.setRequestHeader;
    XMLHttpRequest.prototype.setRequestHeader = function(header, value) {
        const data = xhrData.get(this);
        if (data) {
            data.headers[header] = value;
            
            if (header === 'g-footer' || header === 'g-timestamp') {
                console.log('%cğŸ¯ æ‹¦æˆªåˆ° XHR è¯·æ±‚å¤´ï¼', 'background: #ffc107; color: black; padding: 5px; font-weight: bold;');
                console.log(`${header}:`, value);
                console.trace();
            }
        }
        return originalSetRequestHeader.apply(this, arguments);
    };
    
    const originalSend = XMLHttpRequest.prototype.send;
    XMLHttpRequest.prototype.send = function(body) {
        const data = xhrData.get(this);
        if (data && (data.headers['g-footer'] || data.headers['g-timestamp'])) {
            const capture = {
                timestamp: data.headers['g-timestamp'],
                footer: data.headers['g-footer'],
                body: body,
                url: data.url,
                time: new Date().toISOString()
            };
            
            results.captures.push(capture);
            console.log('%câœ… XHR è¯·æ±‚æ•è·å®Œæˆ', 'background: #28a745; color: white; padding: 5px;');
            analyzeFooter(capture);
        }
        return originalSend.apply(this, arguments);
    };
    
    // ============================================================
    // 3. ç®—æ³•åˆ†æå‡½æ•°
    // ============================================================
    function analyzeFooter(capture) {
        console.log('%câ”'.repeat(80), 'color: #764ba2');
        console.log('%cğŸ§ª å¼€å§‹ç®—æ³•åˆ†æ...', 'background: #667eea; color: white; padding: 5px; font-weight: bold;');
        
        const { timestamp, footer, body } = capture;
        let parsedBody = body;
        
        try {
            parsedBody = typeof body === 'string' ? JSON.parse(body) : body;
        } catch (e) {}
        
        const link = parsedBody?.link || '';
        const videoId = link.match(/v=([^&]+)/)?.[1] || '';
        
        console.log('ğŸ“Š æµ‹è¯•æ•°æ®ï¼š');
        console.log('  - Timestamp:', timestamp);
        console.log('  - Footer:', footer);
        console.log('  - Link:', link);
        console.log('  - Video ID:', videoId);
        console.log('  - Footer é•¿åº¦:', footer.length, 'å­—ç¬¦');
        
        // åˆ¤æ–­å“ˆå¸Œç±»å‹
        let hashType = 'Unknown';
        if (footer.length === 32) hashType = 'MD5';
        else if (footer.length === 40) hashType = 'SHA1';
        else if (footer.length === 64) hashType = 'SHA256';
        
        console.log('  - æ¨æµ‹å“ˆå¸Œç±»å‹:', hashType);
        
        // æµ‹è¯•å¸¸è§ç»„åˆ
        const testCases = [
            { name: 'timestamp', value: timestamp },
            { name: 'link', value: link },
            { name: 'videoId', value: videoId },
            { name: 'timestamp + link', value: timestamp + link },
            { name: 'link + timestamp', value: link + timestamp },
            { name: 'timestamp + videoId', value: timestamp + videoId },
            { name: 'timestamp:link', value: `${timestamp}:${link}` },
            { name: 'JSON body', value: body },
            { name: 'timestamp + body', value: timestamp + body },
        ];
        
        console.log('%cğŸ’¡ å¯èƒ½çš„è¾“å…¥ç»„åˆï¼š', 'color: #667eea; font-weight: bold;');
        testCases.forEach((test, i) => {
            console.log(`  ${i + 1}. ${test.name}: "${test.value}"`);
        });
        
        console.log('%câ”'.repeat(80), 'color: #764ba2');
        console.log('%cğŸ“‹ å¤åˆ¶ä»¥ä¸‹æ•°æ®ç”¨äº Python æµ‹è¯•ï¼š', 'background: #17a2b8; color: white; padding: 5px; font-weight: bold;');
        console.log('TEST_LINK = "' + link + '"');
        console.log('TEST_TIMESTAMP = ' + timestamp);
        console.log('ACTUAL_G_FOOTER = "' + footer + '"');
        console.log('%câ”'.repeat(80), 'color: #764ba2');
    }
    
    // ============================================================
    // 4. æœç´¢å¯ç–‘å‡½æ•°
    // ============================================================
    console.log('%cğŸ” æœç´¢å…¨å±€ä½œç”¨åŸŸä¸­çš„å¯ç–‘å‡½æ•°...', 'color: #667eea; font-weight: bold;');
    const suspiciousKeys = [];
    
    for (let key in window) {
        const lowercaseKey = key.toLowerCase();
        if (lowercaseKey.includes('footer') || 
            lowercaseKey.includes('sign') || 
            lowercaseKey.includes('signature') ||
            lowercaseKey.includes('hash') ||
            lowercaseKey.includes('md5') ||
            lowercaseKey.includes('sha') ||
            lowercaseKey.includes('encrypt') ||
            lowercaseKey.includes('crypto')) {
            
            suspiciousKeys.push({ key, type: typeof window[key] });
            console.log(`  ğŸš¨ ${key} (${typeof window[key]})`);
            
            if (typeof window[key] === 'function') {
                try {
                    console.log('    æºç :', window[key].toString().substring(0, 200) + '...');
                } catch (e) {}
            }
        }
    }
    
    results.functions = suspiciousKeys;
    
    if (suspiciousKeys.length === 0) {
        console.log('  â„¹ï¸  æœªå‘ç°æ˜æ˜¾çš„ç­¾åç›¸å…³å‡½æ•°ï¼ˆå¯èƒ½è¢«æ··æ·†ï¼‰');
    }
    
    // ============================================================
    // 5. æä¾›è¾…åŠ©å‡½æ•°
    // ============================================================
    window.snapanyDebug = {
        getCaptures: () => results.captures,
        getFunctions: () => results.functions,
        getLatest: () => results.captures[results.captures.length - 1],
        clear: () => { results.captures = []; results.functions = []; },
        help: () => {
            console.log('%câ”'.repeat(80), 'color: #667eea');
            console.log('%cğŸ“š å¯ç”¨çš„è°ƒè¯•å‘½ä»¤ï¼š', 'background: #667eea; color: white; padding: 5px; font-weight: bold;');
            console.log('  snapanyDebug.getCaptures()  - è·å–æ‰€æœ‰æ•è·çš„æ•°æ®');
            console.log('  snapanyDebug.getLatest()    - è·å–æœ€æ–°æ•è·çš„æ•°æ®');
            console.log('  snapanyDebug.getFunctions() - è·å–å¯ç–‘å‡½æ•°åˆ—è¡¨');
            console.log('  snapanyDebug.clear()        - æ¸…ç©ºæ•è·è®°å½•');
            console.log('  snapanyDebug.help()         - æ˜¾ç¤ºæ­¤å¸®åŠ©');
            console.log('%câ”'.repeat(80), 'color: #667eea');
        }
    };
    
    console.log('%câœ… æ‹¦æˆªå™¨å®‰è£…å®Œæˆï¼', 'background: #28a745; color: white; padding: 10px; font-size: 16px; font-weight: bold;');
    console.log('%cğŸ’¡ æç¤ºï¼šè¾“å…¥ snapanyDebug.help() æŸ¥çœ‹å¯ç”¨å‘½ä»¤', 'color: #667eea; font-weight: bold;');
    console.log('%cğŸš€ ç°åœ¨å¯ä»¥åœ¨ç½‘ç«™ä¸Šæµ‹è¯•äº†ï¼', 'color: #667eea; font-weight: bold;');
})();</pre>
            </div>
        </div>
        
        <div class="section">
            <h2>âš ï¸ é‡è¦æç¤º</h2>
            <div class="alert alert-warning">
                <strong>âš ï¸ æ³•å¾‹ä¸é“å¾·å£°æ˜ï¼š</strong><br>
                æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ç›®çš„ä½¿ç”¨ã€‚é€†å‘å·¥ç¨‹å¯èƒ½è¿åæœåŠ¡æ¡æ¬¾æˆ–ç›¸å…³æ³•å¾‹æ³•è§„ã€‚ä½¿ç”¨å‰è¯·ç¡®ä¿ï¼š
                <ul style="margin: 10px 0 0 20px;">
                    <li>ä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œæµ‹è¯•</li>
                    <li>ä¸ç”¨äºå•†ä¸šç›®çš„</li>
                    <li>éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„</li>
                    <li>å°Šé‡æœåŠ¡æä¾›å•†çš„æƒç›Š</li>
                </ul>
            </div>
            
            <div class="alert alert-info">
                <strong>ğŸ’¡ å»ºè®®çš„åˆæ³•é€”å¾„ï¼š</strong><br>
                å¦‚éœ€å•†ä¸šä½¿ç”¨ï¼Œè¯·è”ç³» SnapAny å®˜æ–¹ï¼š
                <ul style="margin: 10px 0 0 20px;">
                    <li>ğŸ“§ Email: hi@iiilab.com</li>
                    <li>ğŸŒ Website: https://snapany.com/</li>
                    <li>ç”³è¯·å®˜æ–¹ API å¯†é’¥å’Œæ–‡æ¡£</li>
                </ul>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ“– é¢„æœŸè¾“å‡º</h2>
            <p>è¿è¡Œè„šæœ¬åï¼Œå½“ä½ åœ¨ SnapAny ç½‘ç«™ä¸Šæå–è§†é¢‘æ—¶ï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤ºï¼š</p>
            <ul style="margin: 15px 0 0 20px; line-height: 2;">
                <li>âœ… æ•è·çš„ <code>g-footer</code> å’Œ <code>g-timestamp</code> å€¼</li>
                <li>ğŸ“Š è¯¦ç»†çš„è¯·æ±‚å‚æ•°åˆ†æ</li>
                <li>ğŸ” è°ƒç”¨å †æ ˆï¼ˆæ‰¾å‡ºç”Ÿæˆç­¾åçš„å‡½æ•°ä½ç½®ï¼‰</li>
                <li>ğŸ’¡ å¯èƒ½çš„è¾“å…¥å‚æ•°ç»„åˆ</li>
                <li>ğŸ“‹ Python æµ‹è¯•ä»£ç ï¼ˆå¯ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼‰</li>
            </ul>
        </div>
        
        <footer>
            <p>ğŸ”§ Created for educational purposes only | ä»…ä¾›å­¦ä¹ ä½¿ç”¨</p>
            <p style="margin-top: 10px;">Â© 2025 LittleSprout Reading Project</p>
        </footer>
    </div>
    
    <script>
        function copyScript() {
            const script = document.getElementById('interceptor-script').textContent;
            navigator.clipboard.writeText(script).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'âœ… å·²å¤åˆ¶ï¼';
                btn.style.background = '#28a745';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#667eea';
                }, 2000);
            }).catch(err => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¹¶å¤åˆ¶');
                console.error('å¤åˆ¶å¤±è´¥:', err);
            });
        }
    </script>
</body>
</html>
